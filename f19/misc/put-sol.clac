: // Puts a value at an arbitrary index in the stack    ;
: // Usage:                                             ;
: // S, x(n), x(n-1), ..., x(1), y, n || put, Q         ;
: //      =>  S, y, x(n-1), ..., x(1) || Q              ;
: // Jonathan Burns, 7/19/2017                          ;

: > swap < ;

: put 1 pick 1 > if put_continue 3 skip drop swap drop ;

: put_continue 3 pick if put_iter 6 skip rot drop 1 - put 0 ;

: put_iter 3 pick 2 % if put_addsub 1 skip put_divide ;

: put_divide rot 2 / rot rot put_continue 2 * ;

: put_addsub 3 pick 0 < if put_add 1 skip put_sub ;

: put_add rot 1 + rot rot put_continue 1 - ;

: put_sub rot 1 - rot rot put_continue 1 + ;
