#use <conio>
#use "sol-tbuf.c0"

//EXPECT RETURN 0

int main()
{
  bool passed = true;
  tbuf B = tbuf_new_();

  //split on right
  insert_char_(B, 'a');
  insert_char_(B, 'b');
  insert_char_(B, 'c');
  insert_char_(B, 'd');
  insert_char_(B, 'e');
  insert_char_(B, 'f');
  insert_char_(B, 'g');
  insert_char_(B, 'h');
  insert_char_(B, 'i');
  insert_char_(B, 'j');
  insert_char_(B, 'k');
  insert_char_(B, 'l');
  insert_char_(B, 'm');
  insert_char_(B, 'n');
  insert_char_(B, 'o');
  insert_char_(B, 'p');

  for(int i = 0; i < 5; i++)
    gapbuf_backward_(B->point->data);
 
  split_point(B);
  
  //check exact positioning
  if(!(B->point->prev->data->limit == 16 &&
       B->point->prev->data->buffer[0] == 'a' &&
       B->point->prev->data->buffer[1] == 'b' &&
       B->point->prev->data->buffer[2] == 'c' &&
       B->point->prev->data->buffer[3] == 'd' &&
       B->point->prev->data->buffer[4] == 'e' &&
       B->point->prev->data->buffer[5] == 'f' &&
       B->point->prev->data->buffer[6] == 'g' &&
       B->point->prev->data->buffer[7] == 'h' &&
       B->point->prev->data->gap_start == 8 &&
       B->point->prev->data->gap_end == 16 &&
       B->point->data->limit == 16 &&
       B->point->data->buffer[0] == 'i' &&
       B->point->data->buffer[1] == 'j' &&
       B->point->data->buffer[2] == 'k' &&
       B->point->data->buffer[11] == 'l' &&
       B->point->data->buffer[12] == 'm' &&
       B->point->data->buffer[13] == 'n' &&
       B->point->data->buffer[14] == 'o' &&
       B->point->data->buffer[15] == 'p' &&
       B->point->data->gap_start == 3 &&
       B->point->data->gap_end == 11)) {
    passed = false;
    // error("there was a discrepancy in the split output");
  }

  //report
  if(passed) return 0; else return 1;
}
