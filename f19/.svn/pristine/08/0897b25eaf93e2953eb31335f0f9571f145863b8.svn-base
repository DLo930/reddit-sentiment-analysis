\clearpage
\Question{Heaps}
\bgroup
\newcommand{\heapversion}{heap1} % F19 F18
%\newcommand{\heapversion}{heap2} % S19 S18
\newcommand{\newelem}{\ifdefstring{\heapversion}{heap1}{5}{11}}

\newcommand{\insseq}
%{31, 27, 44, 30,  3, 29, 49, 26} % S19
%{29, 25, 42, 27,  9, 28, 46, 24} % F18
%{27, 23, 40, 25,  7, 26, 44, 22} % S18
 {55, 47, 80, 51, 14, 52, 85, 45} % F19, F17

As discussed in class, a \emph{min-heap} is a hierarchical data structure
that satisfies two invariants:

\begin{quote}
\textbf{Order}: Every child has value greater than or equal to its parent.

\textbf{Shape}: Each level of the min-heap is completely full except
possibly the last level, which has all of its elements stored as far
left as possible. (Also known as a \emph{complete} binary tree).
\end{quote}
Smaller integer values represent higher priorities.
Consider:
\begin{center}
\vspace{-2.5ex}
\includegraphics[scale=0.7]{\img/\heapversion.png}
\end{center}

\vspace{-1.5ex}
\begin{parts}

\part[0\half]\TAGS{pq}
Draw a picture of the final state of this min-heap after an element
with value \newelem{} is inserted.  Satisfy the shape invariant first,
then restore the order invariant while maintaining the shape
invariant.  Draw all branches in your tree \emph{clearly} so we can
distinguish left branches from right branches.

\begin{framed}
  \ifprintanswers
  \begin{center}
    \includegraphics[height=1.5in]{\img/\heapversion-ins.png}
  \end{center}
\else\vspace{1.6in}~\fi
\end{framed}

\RUBRIC
Part (a)
TAGS: pq

Gradescope rubric:
+0.5pt Correct answer

Commentary:
all or nothing

Version 1
              2
        /----/  \----\
      4               3
    /   \           /  \
   5     7         8    6
  / \
17   9


Version 2
              5
        /----/  \----\
      9               7
    /   \           /  \
  11    15         17  13
  / \
35   19

ENDRUBRIC

\part[0\half]\TAGS{pq}
Starting from the \emph{original} min-heap above, draw a picture of
the final state of the min-heap after the element with the minimum
value (i.e., with highest priority) is deleted. Satisfy the shape
invariant first, then restore the order invariant while maintaining
the shape invariant.

\begin{framed}
  \ifprintanswers
  \begin{center}
    \includegraphics[height=1.2in]{\img/\heapversion-del.png}
  \end{center}
\else\vspace{1.6in}~\fi
\end{framed}

\RUBRIC
Part (b)
TAGS: pq

Gradescope rubric:
+ 0.25 pts Answer satisfies ordering and shape invariants
+ 0.25 pts Answer depicts the correct heap

Commentary:
  +1/4 point if wrong but obeys heap shape and heap ordering invariants

  Version 1:
              3
        /----/ \----\
       4             6
      / \           / \
     9   7         8  17

  Version 2:
              7
        /----/ \----\
       9            13
      / \           / \
     19 15         17 35

ENDRUBRIC


\part[1\half]\TAGS{pq}
% Vary from time to time
Insert the following values into an \emph{initially empty} min-heap
one at a time in the order shown. Draw the final state of the min-heap
after each insert is completed and the min-heap is restored back to
its proper invariants. Your answer should show 8 clearly drawn heaps.

\medskip
\begin{center}\tt
\insseq
\end{center}

\medskip
\begin{framed} % Paste the appropriate version
\ifprintanswers
\begin{lstlisting}[basicstyle=\basicstyle\color{\answerColor}]
                          47            14            14
                        /    \        /    \        /    \
        47    47      51      80    47      80    47      52
       /     /  \    /             /  \          /  \    /
  55  55    55   80 55            55  51        55  51  80

                                  14
                            /----/  \----\
        14               45              52
      /    \            /    \          /    \
    47      52        47      51      80      85
   /  \    /  \      /
  55  51  80   85  55
\end{lstlisting}
\else~\vspace{7.2in}\fi
\end{framed}

\RUBRIC
Part (c)
TAGS: pq

Gradescope rubric:
+ 0.3 pts Shape Invariant is right everywhere
+ 0.4 pts No more than 2 wrong trees
+ 0.4 pts No more than 1 wrong tree OR 1 propagated mistake
+ 0.4 pts Fully correct

Commentary:
  Partial credit: Do not attempt to trace whether a mistake is
  consistently carried through, unless it's honkingly obvious.
    1.1 points if they show one wrong tree; or if it's very very
  obvious to you that they made one mistake and then carried it through.
    0.7 point if they show two or three wrong trees
    0.3 point if the shape invariant is at least right everywhere

Version 1:
                          47            14            14
                        /    \        /    \        /    \
        47    47      51      80    47      80    47      52
       /     /  \    /             /  \          /  \    /
  55  55    55   80 55            55  51        55  51  80

                                  14
                            /----/  \----\
        14               45              52
      /    \            /    \          /    \
    47      52        47      51      80      85
   /  \    /  \      /
  55  51  80   85  55

Version 2:
                          23             7            7
                        /    \        /    \        /    \
        23    23      25      40    23      40    23      26
       /     /  \    /             /  \          /  \    /
  27  27    27   40 27            27  25        27  25  40

                                   7
                            /----/  \----\
         7               22              26
      /    \            /   \          /    \
    23      26        23     25      40      44
   /  \    /  \      /
  27  25  40   44  27

Version 3:
                          25             9            9
                        /    \        /    \        /    \
        25    25      27      42    25      42    25      28
       /     /  \    /             /  \          /  \    /
  29  29    29   42 29            29  27        29  27  42

                                   9
                            /----/  \----\
         9               24              28
      /    \            /   \          /    \
    25      28        25     27      42      46
   /  \    /  \      /
  29  27  42   46  29

Version 4:
                          27             3            3
                        /    \        /    \        /    \
        27    27      30      44    27      44    27      29
       /     /  \    /             /  \          /  \    /
  31  31    31   44 31            31  30        31  30  44

                                   3
                            /----/  \----\
         3               26              29
      /    \            /   \          /    \
    27      29        27     30      44      49
   /  \    /  \      /
  31  30  44   49  31

ENDRUBRIC


\newpage
%\input{leaf-count} % S19 S18 S17 F16 S16
\input{heapsort}   % F19 F18 F17 F16 S16

\input{max} % F19 F18 F17 S17 F16
%\input{queue-stack} % S19 S17

\end{parts}
\egroup
